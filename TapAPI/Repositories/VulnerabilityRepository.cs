using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using TapAPI.Models;

namespace TapAPI.Repositories
{
    public class VulnerabilityRepository : IVulnerabilityRepository
	{
		private readonly TapoutDataContext _db;

		public VulnerabilityRepository(TapoutDataContext db)
		{
			this._db = db;
		}

		public List<Vulnerability> GetServerVulnerabilities()
		{
			return _db.Vulnerabilities.ToList();
		}
		public List<ReportType> GetUserRoles(string user)
		{
			return _db.GetUserRoles.Where(t => t.UserName == user).ToList();
		}
		public bool isAllowed(string user, int reportID)
		{
			List<ReportType> allowed = _db.GetUserRoles.Where(t => t.UserName == user && t.ReportNameID == reportID).ToList();
			if (allowed.Count() > 0)
			{
				return true;
			}
			else
			{
				return false;
			}
		}
	}
}
